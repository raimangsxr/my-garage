<div class="profile-container">
    <h2>Edit Profile</h2>

    <div class="current-profile">
        <img [src]="form.get('image_url')?.value || 'assets/images/default-avatar.png'" class="profile-preview"
            alt="Profile">
    </div>

    <form [formGroup]="form" (ngSubmit)="onSubmit()">

        <!-- Image Selection Section -->
        <div class="image-section">
            <h3>Profile Image</h3>

            <!-- Pre-defined Avatars -->
            <div class="avatars-grid">
                <img *ngFor="let avatar of avatars" [src]="avatar" (click)="selectAvatar(avatar)"
                    [class.selected]="form.get('image_url')?.value === avatar" class="avatar-option">
            </div>

            <app-image-cropper (imageCropped)="onImageCropped($event)">
            </app-image-cropper>
        </div>

        <!-- User Details -->
        <div class="details-section">
            <mat-form-field appearance="outline" class="full-width">
                <mat-label>Full Name</mat-label>
                <input matInput formControlName="full_name">
                <mat-error *ngIf="form.get('full_name')?.hasError('required')">Full name is required</mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" class="full-width">
                <mat-label>Email</mat-label>
                <input matInput [value]="user?.email" disabled>
                <mat-hint>Email cannot be changed</mat-hint>
            </mat-form-field>
        </div>

        <div class="actions">
            <button mat-raised-button color="primary" type="submit" [disabled]="form.invalid">
                Save Changes
            </button>
        </div>
    </form>
</div>
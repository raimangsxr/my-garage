<div class="mg-page settings-page">
    <div class="mg-page-header">
        <div class="mg-page-title-wrap">
            <h1 class="mg-page-title">
                <mat-icon>settings</mat-icon>
                Settings
            </h1>
            <p class="mg-page-subtitle">Manage your application preferences and API integrations.</p>
        </div>
    </div>

    <mat-card class="mg-form-card settings-card">
        <mat-card-content>
            <app-page-loader *ngIf="isLoading" icon="settings" message="Loading settings..." minHeight="180px"></app-page-loader>

            <form *ngIf="!isLoading" [formGroup]="settingsForm" (ngSubmit)="onSubmit()">
                <div class="section-title">General</div>

                <div class="form-row">
                    <mat-form-field appearance="outline">
                        <mat-label>Language</mat-label>
                        <mat-select formControlName="language">
                            <mat-option value="en">English</mat-option>
                            <mat-option value="es">Spanish</mat-option>
                        </mat-select>
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                        <mat-label>Currency</mat-label>
                        <mat-select formControlName="currency">
                            <mat-option value="EUR">Euro (€)</mat-option>
                            <mat-option value="USD">US Dollar ($)</mat-option>
                            <mat-option value="GBP">British Pound (£)</mat-option>
                        </mat-select>
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                        <mat-label>Theme</mat-label>
                        <mat-select formControlName="theme">
                            <mat-option value="dark">Dark</mat-option>
                            <mat-option value="light">Light</mat-option>
                            <mat-option value="system">System Default</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>

                <div class="section-title">API Configuration</div>

                <div class="form-row">
                    <mat-form-field appearance="outline">
                        <mat-label>Google Client ID</mat-label>
                        <input matInput formControlName="google_client_id" placeholder="Enter Google Client ID">
                        <mat-hint>Required for Google Sign-In</mat-hint>
                    </mat-form-field>
                </div>

                <div class="form-row">
                    <mat-form-field appearance="outline">
                        <mat-label>Gemini API Key</mat-label>
                        <input matInput [type]="hideGeminiKey ? 'password' : 'text'" formControlName="gemini_api_key"
                            placeholder="Enter Gemini API Key">
                        <button mat-icon-button matSuffix (click)="hideGeminiKey = !hideGeminiKey"
                            [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hideGeminiKey">
                            <mat-icon>{{hideGeminiKey ? 'visibility_off' : 'visibility'}}</mat-icon>
                        </button>
                        <mat-hint>Required for invoice processing</mat-hint>
                    </mat-form-field>
                </div>

                <div class="section-title">Notifications</div>

                <div class="form-row toggle-row">
                    <mat-slide-toggle formControlName="notifications_enabled" color="primary">
                        Enable Notifications
                    </mat-slide-toggle>
                </div>

                <div class="actions">
                    <button mat-raised-button color="primary" type="submit" [disabled]="settingsForm.invalid">
                        Save Changes
                    </button>
                </div>
            </form>
        </mat-card-content>
    </mat-card>
</div>

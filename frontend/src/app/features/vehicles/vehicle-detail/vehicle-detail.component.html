<div class="vehicle-detail-container" *ngIf="!loading && vehicleDetails">
    <!-- Hero Section -->
    <app-vehicle-hero [vehicle]="{
            brand: vehicleDetails.vehicle.brand,
            model: vehicleDetails.vehicle.model,
            license_plate: vehicleDetails.vehicle.license_plate,
            image_url: vehicleDetails.vehicle.image_url
        }" (backClick)="goBack()">
    </app-vehicle-hero>

    <!-- Stats Bar -->
    <app-vehicle-stats-bar [vehicle]="{
            year: vehicleDetails.vehicle.year,
            kilometers: vehicleDetails.vehicle.kilometers,
            next_itv_date: vehicleDetails.vehicle.next_itv_date
        }" [specs]="vehicleDetails.specs">
    </app-vehicle-stats-bar>

    <!-- Related Entities Grid -->
    <div class="entities-grid">
        <!-- Maintenance Column -->
        <app-entity-column title="Maintenance" icon="build" [count]="vehicleDetails.maintenances.length">
            <app-maintenance-timeline [maintenances]="vehicleDetails.maintenances"
                (maintenanceClick)="openMaintenanceDialog($event)">
            </app-maintenance-timeline>
        </app-entity-column>

        <!-- Parts Column -->
        <app-entity-column title="Parts" icon="extension" [count]="getAllParts().length">
            <div class="entity-list">
                <app-entity-card *ngFor="let part of getAllParts()" (cardClick)="openPartDialog(part)">
                    <div class="card-title">{{ part.name }}</div>
                    <div class="card-subtitle" *ngIf="part.reference">Ref: {{ part.reference }}</div>
                    <div class="card-meta">
                        <span><mat-icon>euro</mat-icon> {{ part.price | number:'1.2-2' }}â‚¬</span>
                        <span *ngIf="part.supplier"><mat-icon>store</mat-icon> {{ part.supplier.name }}</span>
                    </div>
                </app-entity-card>
                <app-empty-state *ngIf="getAllParts().length === 0" icon="build_circle" message="No parts registered">
                </app-empty-state>
            </div>
        </app-entity-column>

        <!-- Torque Specifications Column -->
        <app-entity-column title="Torque Specs" icon="build_circle" [count]="6">
            <app-torque-specs></app-torque-specs>
        </app-entity-column>
    </div>
</div>

<div *ngIf="loading" class="loading-container">
    <mat-icon>directions_car</mat-icon>
    <p>Loading vehicle details...</p>
</div>